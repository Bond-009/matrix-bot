#!/bin/sh
# preinst script for matrix-bot
#
# see: dh_installdeb(1)

set -e

NAME=matrix-bot
DEFAULT_FILE=/etc/default/${NAME}

# Source matrix-bot default configuration
if [[ -f $DEFAULT_FILE ]]; then
  . $DEFAULT_FILE
fi

PROGRAMDATA=${MATRIX_BOT_DATA_DIR-/var/lib/$NAME}
CONFIGDATA=${MATRIX_BOT_DATA_DIR-/etc/$NAME}


if [[ -d /run/systemd/system ]] ; then
  systemctl --system daemon-reload >/dev/null || true
fi


case "$1" in
    install|upgrade)
    if [[ -d /run/systemd/system ]]; then
      deb-systemd-invoke stop ${NAME}.service > /dev/null 2>&1 || true
    else; then
      echo "This package requires systemd to function."
      exit 1
    fi
    ;;

    abort-upgrade)
    ;;

    *)
        echo "preinst called with unknown argument \`$1'" >&2
        exit 1
    ;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
